@using System.Data;
@{
    ViewBag.Title = "Child Managemant";
    Layout = "~/Views/Shared/_Layout.cshtml";

    DataSet dsChildren = SurveyApp.DataHelper.ChildGetAll();
}

@functions{
    public string getStatusDescription(int statusId) {
        switch (statusId)
        {
            case 1:
                return "Enrolled";
            case 2:
                return "Lost Followup";
            case 3:
                return "Withdrew Consent";
            case 4:
                return "No Longer at School";
            default:
                return "Not Enrolled";
        }
    }
}

<script type="text/javascript">
    $(function () {
        $("#tblChildren").DataTable({ dom: 'Bfrtip', buttons: [{ extend: 'excel', text: "Export to Excel", title: 'Children_List' }] });
        });
</script>
<div>
    <h2 class="col-sm-11" style="margin: 0px;padding: 0px;">Child Management</h2>
    <a href="@Url.Action("ChildAddEdit", "Child")" class="btn btn-default" style="float:right;"><i class="fa fa-child"></i>&nbsp;Add Child</a>
    @*@Html.ActionLink("Add Child", "ChildAddEdit", "Child", new object { }, new { @class = "btn btn-default", style = "float:right;" })*@
</div>
<div style="clear:both;"></div>
<br />
<style>
    .table-hover tbody tr{cursor:pointer;}
</style>
<table class="table table-striped table-hover" id="tblChildren">
    <thead>
        <tr>
            <th>Name</th>
            <th>DOB</th>
            <th>School</th>
            <th>Parent</th>
            <th>Teacher(s)</th>
            <th>Study(s)</th>
            <th>Status</th>
            <th style="width: 50px;">Action</th>
        </tr>
    </thead>
    <tbody>
        @if (dsChildren != null && dsChildren.Tables.Count > 0 && dsChildren.Tables[0] != null && dsChildren.Tables[0].Rows.Count > 0)
        {
            foreach (DataRow dr in dsChildren.Tables[0].Rows)
            {
                <tr onclick="location.href = '@Url.Action("ChildAddEdit", "Child", new { id = dr["Id"] })';">
                    <td>@dr["Name"]</td>
                    <td>@(dr["dob"] != DBNull.Value ? Convert.ToDateTime(dr["dob"]).ToString("MM/dd/yyyy") : "")</td>
                    <td>@dr["School"]</td>
                    <td>@dr["Parent"]</td>
                    <td>@dr["Teacher"]</td>
                    <td>@dr["Study"]</td>
                    <td class="text-success">@getStatusDescription((int)dr["StatusId"])</td>
                    <td style="text-align: center;vertical-align:middle;"><a href="javascript:void(0);" class="redCross" onclick="event.stopPropagation();deleteListItem(this, @dr["Id"], 'child', '@dr["Name"]');"></a></td>
                </tr>
            }
        }

    </tbody>
</table>