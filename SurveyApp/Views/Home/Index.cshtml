@using SurveyApp.Models;
@using System.Data;

@{
    ViewBag.Title = "Dashboard";
    Layout = "~/Views/Shared/_Layout.cshtml";

    int studyId = Model == null ? 0 : (int)Model;
}

<style type="text/css">
    .stats .separator{clear:both;margin-bottom: 10px;}
    .topControls #ddlStudy{float: right; width: 22%; background-color: #fff;}
    .topStats .itembox{width: 16.51%;padding: 4px;}
    .topStats .info-box {min-height: 121px;}
</style>


@section featured {
    <section class="featured">
        <div class="content-wrapper">
            <hgroup class="title">
                <h2>Admin Dashboad</h2>
            </hgroup>            
        </div>
    </section>
}

<div class="stats">
    <div class="topControls">
        <select id="ddlStudy" class="col-sm-9 form-control" onchange="getStudyInfo(this);">
            <option value="0" @(studyId == 0 ? "selected=selected" : "")>All Studies</option>
        @foreach (Study objStudy in Study.StudyGetAll())
        {
            <option value="@objStudy.Id"  @(studyId == objStudy.Id ? "selected=selected" : "")>@objStudy.Name</option>
        }
        </select>
    </div>

    <div class="separator"></div>
    @{Html.RenderPartial("_ChildrenCounts", studyId);}

    <div class="separator"></div>
    @{Html.RenderPartial("_SurveyCompletion", studyId);}

</div>

<script type="text/javascript">
    function getStudyInfo(elem) {
        var studyId = $(elem).val();
        location.href = "@Url.Action("Index", "Home")" + "?studyId=" + (studyId == 0 ? "" : studyId);
    }
</script>


@*@{Html.RenderPartial("_Charts");}*@